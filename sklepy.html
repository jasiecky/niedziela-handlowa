<!DOCTYPE html>
<html lang="pl-PL">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#ffffff">

  <title>Otwarte sklepy w niedzielę – NiedzielaHandlowa.info</title>
  <meta name="description" content="Zobacz na mapie aktualnie otwarte sklepy i miejsca, w których zrobisz zakupy w niedzielę. Automatyczne filtrowanie „otwarte teraz” i najważniejsze kategorie handlowe." />
  <meta name="author" content="NiedzielaHandlowa.info" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <meta name="google-adsense-account" content="ca-pub-4085660688523771" />

  <link rel="canonical" href="https://www.niedzielahandlowa.info/sklepy" />
  <link rel="alternate" hreflang="pl-PL" href="https://www.niedzielahandlowa.info/sklepy" />
  <link rel="sitemap" type="application/xml" href="https://www.niedzielahandlowa.info/sitemap.xml" />

  <!-- Performance -->
  <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
  <link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin>

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="NiedzielaHandlowa.info" />
  <meta property="og:url" content="https://www.niedzielahandlowa.info/sklepy" />
  <meta property="og:title" content="Otwarte sklepy w niedzielę" />
  <meta property="og:description" content="Mapa otwartych punktów zakupowych „otwarte teraz”: spożywcze, piekarnie, apteki, stacje benzynowe, kioski i galerie." />
  <meta property="og:locale" content="pl_PL" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Otwarte sklepy w niedzielę" />
  <meta name="twitter:description" content="Sprawdź na mapie, które sklepy są teraz otwarte w pobliżu." />

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4085660688523771" crossorigin="anonymous"></script>

  <style>
    :root{
      --step--1: clamp(0.85rem, 0.82rem + 0.15vw, 0.95rem);
      --step-0: clamp(1rem, 0.96rem + 0.3vw, 1.125rem);
      --step-1: clamp(1.25rem, 1.1rem + 0.9vw, 1.6rem);
      --step-2: clamp(1.6rem, 1.3rem + 1.6vw, 2.1rem);
      --radius: 12px;
      --shadow-1: 0 2px 6px rgba(0,0,0,.05);
      --shadow-2: 0 4px 12px rgba(0,0,0,.06);
      --bg: #f9fafb; --card: #ffffff; --text: #111827; --muted: #6b7280; --muted-2: #374151;
      --brand: #1d4ed8; --pill: #f1f5f9; --link: #1f2937; --accent: #0ea5e9;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);line-height:1.7;padding:env(safe-area-inset-top) 1rem env(safe-area-inset-bottom)}
    .page{display:grid;grid-template-columns:minmax(0,1fr);gap:16px;align-items:start;max-width:1400px;margin:0 auto;width:100%}
    .container{max-width:960px;width:100%;margin:0 auto;padding-inline:clamp(.5rem,2vw,1rem)}
    header{margin-bottom:1rem}
    nav[aria-label="Główne"]{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow-1);padding:.9rem clamp(1rem,2vw,2rem)}
    .navbar-list{display:flex;justify-content:center;flex-wrap:wrap;list-style:none;gap:clamp(.75rem,2vw,2rem)}
    .navbar-list a{text-decoration:none;color:var(--link);font-weight:600;padding:.35rem .7rem;border-radius:8px;transition:background-color .2s ease}
    .navbar-list a:hover{background:rgba(125,125,125,.08)}

    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow-2);padding:clamp(1rem,2.5vw,2rem);margin-bottom:1rem}
    .center{text-align:center}
    .card h1{font-size:var(--step-2);color:var(--brand);margin-bottom:.6rem;line-height:1.25;text-align:center}
    .card h2{font-size:var(--step-1);color:var(--text);margin-bottom:.75rem;text-align:center}
    .lead{color:var(--muted-2);margin-bottom:.75rem;font-size:var(--step-0);text-align:center}
    .lead-small{color:var(--muted);font-size:var(--step--1);text-align:center}

    .map-wrap{width:100%; height: 480px; border-radius:12px; overflow:hidden; box-shadow:var(--shadow-2); background:#e5e7eb}
    #map{width:100%; height:100%}
    .results{margin-top:1rem; display:grid; gap:.5rem}
    .place{background:var(--pill); border-radius:10px; padding:.6rem .8rem}
    .place b{color:#111827}
    .place small{color:var(--muted)}

    .ad{display:block;margin:12px auto;min-height:90px}
    .ad-wrapper{text-align:center;margin:0 0 1rem 0}
    .rail{display:none;position:relative;padding-top:.25rem}
    .rail .ad{min-height:250px;width:100%;max-width:300px;margin:0 auto 16px}

    @media (min-width:768px){
      .container{padding-inline:clamp(1rem,3vw,2rem)}
      .card{margin-bottom:1.25rem}
    }
    @media (min-width:1200px){
      .page{grid-template-columns:280px minmax(0,960px);gap:20px}
      .rail.left{display:block}
      .container{padding-inline:0}
    }
    @media (min-width:1440px){
      .page{grid-template-columns:300px minmax(0,960px) 300px}
      .rail.right{display:block}
    }
  </style>

  <!-- Structured data -->
  <script type="application/ld+json">
  [
    {"@context":"https://schema.org","@type":"WebSite","name":"NiedzielaHandlowa.info","url":"https://www.niedzielahandlowa.info/","inLanguage":"pl-PL"},
    {"@context":"https://schema.org","@type":"WebPage","name":"Otwarte sklepy w niedzielę","url":"https://www.niedzielahandlowa.info/sklepy","isPartOf":{"@type":"WebSite","name":"NiedzielaHandlowa.info","url":"https://www.niedzielahandlowa.info/"},"about":{"@type":"Thing","name":"Otwarte sklepy w niedzielę w Polsce"},"inLanguage":"pl-PL"},
    {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[
      {"@type":"Question","name":"Jak znaleźć sklepy otwarte w niedzielę?","acceptedAnswer":{"@type":"Answer","text":"Ta strona automatycznie wykrywa Twoją lokalizację (lub ustawia Warszawę jako punkt startowy), a następnie pokazuje na mapie otwarte teraz punkty zakupowe. Nie musisz niczego ustawiać."}},
      {"@type":"Question","name":"Jakie miejsca są uwzględnione?","acceptedAnswer":{"@type":"Answer","text":"Prezentujemy kategorie: sklepy spożywcze i supermarkety, piekarnie, apteki, stacje benzynowe, sklepy całodobowe/kioski oraz galerie handlowe. Wszystkie są filtrowane pod kątem „otwarte teraz”."}},
      {"@type":"Question","name":"Czy godziny są na pewno aktualne?","acceptedAnswer":{"@type":"Answer","text":"Dane pochodzą z Google Places i są aktualizowane przez właścicieli oraz użytkowników. Zalecamy sprawdzić profil sklepu lub zadzwonić przed wizytą, szczególnie w okresach świątecznych."}}
    ]}
  ]
  </script>
</head>
<body>
  <div class="page">
    <!-- Lewy rail -->
    <aside class="rail left" role="complementary" aria-label="Reklama - lewa kolumna">
      <div class="ad-wrapper">
        <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="1111111111" data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>
      <div class="ad-wrapper">
        <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="2222222222" data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>
    </aside>

    <!-- Główny kontent -->
    <div class="container">
      <header>
        <nav aria-label="Główne">
          <ul class="navbar-list">
            <li><a href="/">Strona główna</a></li>
            <li><a href="/kalendarz">Niedziele handlowe</a></li>
            <li><a href="/sklepy" aria-current="page">Otwarte sklepy</a></li>
          </ul>
        </nav>
      </header>

      <!-- In-content Ad #1 -->
      <div class="ad-wrapper" aria-label="Reklama - in content 1" role="complementary">
        <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="3333333333" data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>

      <main id="content" role="main">
        <section class="card center" id="intro">
          <h1>Otwarte sklepy w niedzielę</h1>
          <p class="lead">
            Poniżej widzisz mapę <strong>otwartych teraz</strong> punktów, w których zrobisz zakupy w niedzielę:
            sklepy spożywcze i supermarkety, piekarnie, apteki, stacje benzynowe, sklepy całodobowe/kioski oraz galerie handlowe.
            Lokalizacja jest wykrywana automatycznie; jeśli się nie powiedzie, startujemy z centrum Warszawy.
          </p>
          <p class="lead-small" id="lastUpdated"></p>
        </section>

        <!-- In-content Ad #2 -->
        <div class="ad-wrapper" aria-label="Reklama - in content 2" role="complementary">
          <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="4444444444" data-ad-format="auto" data-full-width-responsive="true"></ins>
        </div>

        <section class="card" id="mapCard">
          <h2>Mapa otwartych sklepów</h2>
          <div class="map-wrap"><div id="map" role="region" aria-label="Mapa otwartych sklepów"></div></div>
          <div class="results" id="results" aria-live="polite"></div>
          <p class="lead-small" style="margin-top:.5rem;">
            Źródło godzin otwarcia: Google Maps / Places. W okresach świątecznych godziny mogą się zmieniać — sprawdź profil sklepu.
          </p>
        </section>

        <!-- In-content Ad #3 -->
        <div class="ad-wrapper" aria-label="Reklama - in content 3" role="complementary">
          <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="5555555555" data-ad-format="auto" data-full-width-responsive="true"></ins>
        </div>
      </main>

      <footer class="center">
        &copy; <span id="year"></span> NiedzielaHandlowa.info. Wszelkie prawa zastrzeżone.
      </footer>
    </div>

    <!-- Prawy rail -->
    <aside class="rail right" role="complementary" aria-label="Reklama - prawa kolumna">
      <div class="ad-wrapper">
        <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="6666666666" data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>
      <div class="ad-wrapper">
        <ins class="adsbygoogle ad" style="display:block" data-ad-client="ca-pub-4085660688523771" data-ad-slot="7777777777" data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>
    </aside>
  </div>

  <!-- AdSense init -->
  <script>
    window.addEventListener('DOMContentLoaded', function(){
      try{
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
      }catch(e){}
    });
  </script>

  <!-- Google Maps JS API (Places) – PODMIEŃ KLUCZ API -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&language=pl&region=PL&libraries=places&callback=initMap">
  </script>

  <script>
    let map, placesService, userMarker;
    let markers = [];
    const defaultCenter = { lat: 52.2297, lng: 21.0122 }; // Warszawa
    const OPEN_NOW = true;
    const DEFAULT_RADIUS = 5000; // 5 km
    // Typy punktów zakupowych:
    const TYPES = [
      'grocery_or_supermarket',
      'supermarket',
      'bakery',
      'pharmacy',
      'gas_station',
      'convenience_store',
      'shopping_mall'
    ];

    function setUpdatedStamp(){
      document.getElementById('year').textContent =
        new Date().toLocaleDateString('pl-PL', { year:'numeric', timeZone:'Europe/Warsaw' });
      document.getElementById('lastUpdated').textContent =
        'Aktualizacja: ' + new Date().toLocaleDateString('pl-PL', { timeZone:'Europe/Warsaw' });
    }

    function initMap(){
      setUpdatedStamp();
      map = new google.maps.Map(document.getElementById('map'), {
        center: defaultCenter,
        zoom: 13,
        mapTypeControl: false,
        fullscreenControl: true,
        streetViewControl: false,
      });
      placesService = new google.maps.places.PlacesService(map);

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (pos) => {
            const loc = { lat: pos.coords.latitude, lng: pos.coords.longitude };
            map.setCenter(loc);
            addOrMoveUserMarker(loc);
            runAutoSearch(loc);
          },
          () => runAutoSearch(defaultCenter) // brak zgody → fallback
        );
      } else {
        runAutoSearch(defaultCenter);
      }
    }

    function addOrMoveUserMarker(loc){
      if (!userMarker) {
        userMarker = new google.maps.Marker({
          position: loc,
          map,
          icon: { path: google.maps.SymbolPath.CIRCLE, scale: 8, fillColor: '#2563eb', fillOpacity: 1, strokeColor: '#1e40af', strokeWeight: 2 },
          title: 'Twoja lokalizacja'
        });
      } else {
        userMarker.setPosition(loc);
      }
    }

    function clearMarkers(){
      markers.forEach(m => m.setMap(null));
      markers = [];
    }

    function boundsFromPoints(points){
      const b = new google.maps.LatLngBounds();
      points.forEach(p => b.extend(p));
      return b;
    }

    function runAutoSearch(center){
      clearMarkers();
      document.getElementById('results').innerHTML = '';

      const requests = TYPES.map(type => ({
        location: center,
        radius: DEFAULT_RADIUS,
        type,
        openNow: OPEN_NOW
      }));

      // convenience_store bywa lepiej znajdowany z keyword „kiosk całodobowy”
      requests.push({
        location: center, radius: DEFAULT_RADIUS, keyword: 'kiosk całodobowy', openNow: OPEN_NOW
      });

      const unique = new Map();
      let pending = requests.length;

      const handleResults = (results, status, pagination) => {
        if (status === google.maps.places.PlacesServiceStatus.OK && results) {
          results.forEach(place => {
            if (!unique.has(place.place_id)) {
              unique.set(place.place_id, place);
              addPlaceMarker(place);
              appendResult(place);
            }
          });
          if (pagination && pagination.hasNextPage) {
            setTimeout(() => pagination.nextPage(), 800);
            return;
          }
        }
        pending--;
        if (pending <= 0 && unique.size > 0) {
          try {
            const pts = Array.from(unique.values()).map(p => p.geometry?.location).filter(Boolean);
            if (pts.length) map.fitBounds(boundsFromPoints(pts));
          } catch(e){}
        }
      };

      requests.forEach(req => placesService.nearbySearch(req, handleResults));
    }

    function addPlaceMarker(place){
      if (!place.geometry || !place.geometry.location) return;
      const marker = new google.maps.Marker({
        map,
        position: place.geometry.location,
        title: place.name
      });
      const iw = new google.maps.InfoWindow({
        content: `
          <div style="font-size:13px;line-height:1.4">
            <strong>${place.name}</strong><br/>
            ${place.vicinity || ''}<br/>
            <a href="https://www.google.com/maps/place/?q=place_id:${place.place_id}" target="_blank" rel="noopener">Zobacz w Mapach Google</a>
          </div>`
      });
      marker.addListener('click', () => iw.open({ anchor: marker, map }));
      markers.push(marker);
    }

    function appendResult(place){
      const cont = document.getElementById('results');
      const isOpen = place.opening_hours && place.opening_hours.isOpen && place.opening_hours.isOpen();
      const el = document.createElement('div');
      el.className = 'place';
      el.innerHTML = `
        <b>${place.name}</b><br/>
        <small>${place.vicinity || ''}</small><br/>
        <small>${isOpen ? 'otwarte teraz' : 'sprawdź godziny'} ·
          <a href="https://www.google.com/maps/place/?q=place_id:${place.place_id}" target="_blank" rel="noopener">trasa →</a></small>
      `;
      cont.appendChild(el);
    }

    document.addEventListener('DOMContentLoaded', setUpdatedStamp);
  </script>
</body>
</html>
